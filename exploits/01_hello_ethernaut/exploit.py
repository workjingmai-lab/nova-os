#!/usr/bin/env python3
"""
Ethernaut Level 1: Hello Ethernaut
Basic tutorial level - learn Web3.py interaction
"""

from web3 import Web3
import os
import json

# Ethernaut Hello contract info (Sepolia testnet)
CONTRACT_ADDRESS = "0x4E73b858fD68D5e3b8D4B82532a3368999999999"  # Will get real address from instance
RPC_URL = "https://rpc.sepolia.org"  # Sepolia testnet

def load_credentials():
    """Load private key from secure storage"""
    creds_path = "/home/node/.openclaw/workspace/.secure/eth_credentials.json"
    if os.path.exists(creds_path):
        with open(creds_path) as f:
            return json.load(f)
    return None

def main():
    print("=" * 60)
    print("Ethernaut Level 1: Hello Ethernaut")
    print("=" * 60)
    
    # Check credentials
    creds = load_credentials()
    if not creds:
        print("‚ùå No credentials found. Run setup first.")
        print("   Create: .secure/eth_credentials.json with:")
        print('   {"private_key": "0x...", "address": "0x..."}')
        return
    
    # Connect to testnet
    print(f"\nüîó Connecting to Sepolia testnet...")
    w3 = Web3(Web3.HTTPProvider(RPC_URL))
    
    if not w3.is_connected():
        print("‚ùå Failed to connect to Sepolia")
        return
    
    print(f"‚úÖ Connected to Sepolia (block: {w3.eth.block_number})")
    
    # Setup account
    account = w3.eth.account.from_key(creds['private_key'])
    print(f"üë§ Account: {account.address}")
    
    # Check balance
    balance = w3.eth.get_balance(account.address)
    print(f"üí∞ Balance: {w3.from_wei(balance, 'ether')} ETH")
    
    if balance == 0:
        print("\n‚ö†Ô∏è  Zero balance - need Sepolia ETH from faucet:")
        print("   https://sepoliafaucet.com/")
        print("   https://faucet.sepolia.dev/")
        return
    
    print("\n‚úÖ Ready for testnet exploit execution!")
    print("\nNext steps:")
    print("1. Get instance from Ethernaut UI")
    print("2. Update CONTRACT_ADDRESS in this script")
    print("3. Run: python3 exploit.py --execute")

if __name__ == "__main__":
    main()
